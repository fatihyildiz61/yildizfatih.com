---
// Natro Mail entegrasyonu için contact form handler
// Bu sayfa form verilerini işleyip email gönderir

import BaseLayout from '../layouts/BaseLayout.astro';
import Nav from '../components/Nav.astro';

// Form verilerini al
let name = '';
let email = '';
let subject = '';
let message = '';
let emailSent = false;
let errorMessage = '';

if (Astro.request.method === 'POST') {
  try {
    const formData = Astro.request.formData();
    name = formData.get('name') || '';
    email = formData.get('email') || '';
    subject = formData.get('subject') || '';
    message = formData.get('message') || '';
    
    // Email gönderme işlemi burada yapılacak
    // Natro SMTP kullanarak
    emailSent = true;
  } catch (error) {
    errorMessage = 'Email gönderilirken bir hata oluştu. Lütfen tekrar deneyin.';
  }
}
---

<BaseLayout title="İletişim Formu - Fatih Yıldız Portfolio" description="İletişim formu işleniyor">
  <Nav />
  
  <main class="min-h-screen flex items-center justify-center px-6 pt-32">
    <div class="text-center max-w-2xl mx-auto">
      {emailSent ? (
        <!-- Başarı mesajı -->
        <div class="mb-8">
          <div class="w-32 h-32 mx-auto bg-gradient-to-br from-green-500/20 to-blue-500/20 rounded-full flex items-center justify-center">
            <svg class="w-16 h-16 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
          </div>
        </div>
        
        <h1 class="text-4xl md:text-5xl font-bold text-slate-900 dark:text-white mb-6">
          Teşekkürler!
        </h1>
        
        <p class="text-xl text-slate-600 dark:text-slate-400 mb-8 leading-relaxed">
          Mesajınız başarıyla alındı. En kısa sürede size dönüş yapacağım.
        </p>
        
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href="/" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-all duration-300">
            Ana Sayfaya Dön
          </a>
        </div>
      ) : errorMessage ? (
        <!-- Hata mesajı -->
        <div class="mb-8">
          <div class="w-32 h-32 mx-auto bg-gradient-to-br from-red-500/20 to-orange-500/20 rounded-full flex items-center justify-center">
            <svg class="w-16 h-16 text-red-600 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
            </svg>
          </div>
        </div>
        
        <h1 class="text-4xl md:text-5xl font-bold text-slate-900 dark:text-white mb-6">
          Hata Oluştu
        </h1>
        
        <p class="text-xl text-slate-600 dark:text-slate-400 mb-8 leading-relaxed">
          {errorMessage}
        </p>
        
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a href="/#contact" class="px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-all duration-300">
            Tekrar Dene
          </a>
        </div>
      ) : (
        <!-- Form işleniyor -->
        <div class="mb-8">
          <div class="w-32 h-32 mx-auto bg-gradient-to-br from-blue-500/20 to-purple-500/20 rounded-full flex items-center justify-center">
            <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600"></div>
          </div>
        </div>
        
        <h1 class="text-4xl md:text-5xl font-bold text-slate-900 dark:text-white mb-6">
          İşleniyor...
        </h1>
        
        <p class="text-xl text-slate-600 dark:text-slate-400 mb-8 leading-relaxed">
          Mesajınız gönderiliyor, lütfen bekleyin.
        </p>
      )}
    </div>
  </main>
</BaseLayout>

<style>
  main {
    animation: fadeInUp 0.6s ease-out;
  }
  
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
